#      _          _ _
#     | |        | | |
#  ___| |__   ___| | |_ __ ___
# / __| '_ \ / _ \ | | '__/ __|
# \__ \ | | |  __/ | | | | (__
# |___/_| |_|\___|_|_|_|  \___|

echo "Sourcing ~/.config/shellrc"

export SHELL_SOURCED=1

#source `which user-path-gen`
source "${HOME}/.local/bin/user-path-gen"

if which bw >/dev/null && [[ $USER != "root" ]]; then

	session_file=/tmp/MEOWXIIK_BW_SESSION

	if [[ -f $session_file ]]; then
		source $session_file

		if [[ -z "$BW_SESSION" ]] ; then
			rm $session_file
		fi
	fi

	if [[ ! -f $session_file ]] && [[ $- == *i* ]]; then

		if [[ ! -f ~/.cache/dotfiles_pass ]]; then
			echo -n "Please enter dotfiles password: "
			read -s password
			echo
			# Run Command
			echo $password > ~/.cache/dotfiles_pass
		fi

		#bw login meowxiik+dotfiles@gmail.com
		SESSION=$(bw unlock < ~/.cache/dotfiles_pass | grep "export BW_SESSION" | sed 's/^$ export BW_SESSION=//g' | tr -d \" )
		echo "export BW_SESSION=\"$SESSION\"" > $session_file

		chmod 600 $session_file
	fi

	[[ -f "$session_file" ]] && . "$session_file"

fi

function cd () {
	
	if [[ -d "$1" ]] && [[ -d "$1/.git" ]]; then
		(
			builtin cd "$1"
			dura watch > /dev/null &
		)
	fi

	builtin cd "$@" && ls --color=auto --group-directories-first
}

function ex ()
{
  if [ -f $1 ] ; then
    case $1 in
      *.tar.bz2)   tar xjf $1   ;;
      *.tar.gz)    tar xzf $1   ;;
      *.bz2)       bunzip2 $1   ;;
      *.rar)       unrar x $1   ;;
      *.gz)        gunzip $1    ;;
      *.tar)       tar xf $1    ;;
      *.tbz2)      tar xjf $1   ;;
      *.tgz)       tar xzf $1   ;;
      *.zip)       unzip $1     ;;
      *.Z)         uncompress $1;;
      *.7z)        7z x $1      ;;
      *)           echo "'$1' cannot be extracted via ex()" ;;
    esac
  else
    echo "'$1' is not a valid file"
  fi
}


alias clip="xclip -i -sel clipboard"
alias cls="clear;ls"
alias crow_pycharm="echo $'cd ~/Cloud/PCIIRC/crow3/; . ./install/setup.bash; CROW_CONFIG_DIR=\$(realpath ./config) /opt/pycharm-professional/bin/pycharm.sh' | crow_enter"
alias crow_start="crow_start --extra-mount /opt/pycharm-professional"
alias dei="docker exec -it"
alias dosbox=dosbox -conf "$XDG_CONFIG_HOME"/dosbox/dosbox.conf
alias dotfiles="chezmoi"
alias grep="grep --color=auto"
alias j="journalctl"
alias l="ls -l"
alias la="ls -a"
alias ldo="lazydocker"
alias ll="ls -l"
alias lla="ls -la"
alias llah="ls -lah"
alias llh="ls -lh"
alias ls='ls --color=auto --group-directories-first'
alias lzd="lazydocker"
alias overseer="ssh dns overseer"
alias p="ipython"
alias ros2="[ -d install ] && . ./install/setup.bash; [ -d config ] && CROW_CONFIG_DIR=\$(realpath ./config) ros2"
alias s="systemctl"
alias sdr="systemctl daemon-reload"
alias sudo='sudo '
alias tf="terraform"
alias walr="cat /home/meowxiik/.cache/wal/sequences"
alias wget=wget --hsts-file="$XDG_DATA_HOME/wget-hsts"
alias yay="PKGEXT=.pkg.tar yay"
alias yayforce="yay --mflags \"--nocheck --skippgpcheck --skipchecksums\""

export LANG=en_US.UTF-8
export LC_CTYPE=en_US.UTF-8

export PATH=$PATH:/home/$USER/.local/bin
export PATH=$PATH:/home/$USER/go/bin
export PATH=$PATH:/home/meowxiik/.local/share/gem/ruby/3.0.0/bin
export PATH="$PATH:."
export PATH="$PATH:/usr/local/bin"

if [[ -f ~/Cloud/Software/distrobox/distrobox ]]; then
  export PATH=$PATH:/home/$USER/Cloud/Software/distrobox/
fi

export XDG_CONFIG_HOME="${HOME}/.config"
export XDG_DATA_HOME="${HOME}/.local/share"
export XDG_STATE_HOME="${HOME}/.local/state"
export XDG_CACHE_HOME="${HOME}/.cache"


export TERMINAL=terminator
export BROWSER=firefox
export EDITOR=nvim
export VISUAL=nvim
export GRAPHICSEDITOR=gimp
export SCREENSHOTEDITOR=gimp
export READER=mupdf
export EXPLORER=nemo

export GIT_PAGER="cat"

export ANDROID_SDK_HOME="$XDG_CONFIG_HOME/android"
export APPCODE_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/appcode.properties"
export CARGO_HOME="$XDG_DATA_HOME/cargo"
export CLION_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/clion.properties"
export CONDA_PREFIX="$XDG_CONFIG_HOME/conda/envs/default"
export CONDA_ROOT="$XDG_CONFIG_HOME/conda"
export CUDA_CACHE_PATH="$XDG_CACHE_HOME"/nv
export DATAGRIP_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/datagrip.properties"
export DOCKER_CONFIG="$XDG_CONFIG_HOME"/docker
export DOT_SAGE="$XDG_DATA_HOME"/sage
export GNUPGHOME="$XDG_DATA_HOME/gnupg"
export GOLAND_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/goland.properties"
export GOPATH="$XDG_DATA_HOME"/go
export GTK2_RC_FILES="$XDG_CONFIG_HOME"/gtk-2.0/gtkrc
export GTK_RC_FILES="$XDG_CONFIG_HOME"/gtk-1.0/gtkrc
export IDEA_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/idea.properties"
export INPUTRC="$XDG_CONFIG_HOME"/readline/inputrc
export KAGGLE_CONFIG_DIR="$XDG_CONFIG_HOME/kaggle"
export KDEHOME="$XDG_CONFIG_HOME/kde"
export KERAS_HOME="$XDG_DATA_HOME/keras"
export MATHEMATICA_USERBASE="$XDG_CONFIG_HOME/mathematica"
export MPLAYER_HOME="$XDG_CONFIG_HOME/mplayer"
export NLTK_DATA="${HOME}/.cache/nltk_data"
export NODE_REPL_HISTORY="$XDG_DATA_HOME"/node_repl_history
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
export NUGET_PACKAGES="$HOME/.cache/nuget/packages"
export NUGET_PACKAGES="$XDG_CACHE_HOME/NuGetPackages"
export NVM_DIR="$XDG_DATA_HOME"/nvm
export PHPSTORM_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/phpstorm.properties"
export PYCHARM_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/pycharm.properties"
export PYENV_ROOT=$XDG_DATA_HOME/pyenv
export RIDER_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/rider.properties"
export RUSTUP_HOME="$XDG_DATA_HOME"/rustup
export SQLITE_HISTORY=$XDG_DATA_HOME/sqlite_history
export STUDIO_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/studio.properties"
export UNISON="$XDG_DATA_HOME"/unison
export VAGRANT_ALIAS_FILE="$XDG_DATA_HOME"/vagrant/aliases
export VAGRANT_HOME="$XDG_DATA_HOME"/vagrant
export WEBIDE_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/webide.properties"
export WINEPREFIX="$XDG_DATA_HOME"/wineprefixes/default
export _JAVA_OPTIONS=-Djava.util.prefs.userRoot="$XDG_CONFIG_HOME"/java
export _JAVA_OPTIONS=-Djava.util.prefs.userRoot="$XDG_CONFIG_HOME"/java
