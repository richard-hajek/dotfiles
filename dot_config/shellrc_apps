
#append_path ~/.local/apps

# https://wiki.archlinux.org/title/Debuginfod
# do NOT delete this line
# gdb will NOT be able to start using debuginfod if this variable is not set beforehand

if lsb_release -si 2>/dev/null | grep -qi arch; then
  export DEBUGINFOD_URLS="https://debuginfod.archlinux.org"
fi

export LS_COLORS="di=34:ln=36:so=35:pi=35:ex=32:bd=35:cd=35:su=32:sg=32:tw=34:ow=34"
export BAT_STYLE="plain"
export VCPKG_ROOT="$HOME/.local/share/vcpkg"

export GEM_HOME="$HOME/.local/bundler"


# This block checks for dotfile changes and pesters me to push them
# The following lines will spawn in a subshell - their output will be through notify-send mostly
( ( 

MESSAGE=""

if hash chezmoi &> /dev/null; then
	OUTPUT="$(chezmoi status 2>&1)"

	if [[ ! -z "${OUTPUT// }" ]]; then
        MESSAGE="${OUTPUT}\n"
	fi
fi

if [[ -d "${HOME}/.config/home-manager" ]] ; then
    cd ~/.config/home-manager
    UNSTAGED=$(git diff --numstat | wc -l)
    UNCOMMITED=$(git diff --cached --numstat | wc -l)
    UNPUSHED=$(git diff --numstat HEAD origin | wc -l)
    ALL_CHANGES=$(( $UNSTAGED + $UNCOMMITED + $UNPUSHED )) 

    if [[ ${ALL_CHANGES} != 0 ]]; then
        MESSAGE="${MESSAGE}Some changes in home-manager config"
    fi
fi


if [[ ${MESSAGE} != "" ]]; then
    if hash notify-send &> /dev/null; then
        notify-send "Dotfiles changes:" "${MESSAGE}"
    else
        echo "Dotfiles changes:\n" "${MESSAGE}"
    fi
fi


) & ) 

if [ -f /usr/share/nvm/init-nvm.sh ]; then
	source /usr/share/nvm/init-nvm.sh
fi


if hash zoxide &>/dev/null; then
    eval "$(zoxide init $(basename $SHELL))"
fi


if [[ $SHELL == "/bin/zsh" ]]; then
    if hash aws &> /dev/null; then
        complete -C $(which aws_completer) aws
    fi 
fi


